 "use strict";

(function($) {
$( document ).ready(function() {

var categories;
var values;

var url = document.URL.split('/');
var model_id = url[url.length -2];

$('#select').on('change', function() {

    $.ajax('/models/vulnerability/'+model_id+'/taxonomy/'+$(this).val() )
    .done(function(data) {

        categories = data.iml;
        values = data.function;

        update_vulnerability();
    });


});



var update_vulnerability = function(){

        var chart = new Highcharts.Chart({
            chart: {
                renderTo: 'chart-container',
            },
            title: {
                text: 'Vulnerability Function'
            },
            subtitle: {
                text: ''
            },
            xAxis: {
                categories: categories,
                title: {
                    text: null
                }
            },
            yAxis: {
                min: 0,
                //max: 1.0,
                title: {
                    text: 'Loss ratio',
                },
                labels: {
                    overflow: 'justify'
                }
            },
            tooltip: {
                valueSuffix: ''
            },
            plotOptions: {
                bar: {
                    dataLabels: {
                        enabled: true
                    }
                }
            },
            credits: {
                enabled: false
            },
            series: [{
                id: 'cons',
                name: 'Loss ratio',
                data: values
            },
            ]
        });
    }



});
})($); 